/*! CPAN Distributions List - v0.2.0 - 2013-07-08
* https://github.com/guillaumeaubert/jquery-cpan-distributions-list
* Copyright (c) 2013 Guillaume Aubert; Licensed GPLv3 */
!function(a){function b(b,d){a.ajax({type:"GET",async:!0,dataType:"json",url:"http://api.metacpan.org/v0/release/_search?q=author:"+d.pause_id+"%20AND%20status:latest&fields=version,distribution,date&size=100&sort=distribution",success:function(a){return"false"===a.timed_out?(alert("MetaCPAN timed out ("+a.timed_out+")!"),void 0):0===a.hits.total?(alert("MetaCPAN returned no distributions for this author!"),void 0):(a.hits.hits.forEach(function(a,c){e(b,d,c,a.fields.distribution,a.fields.version,a.fields.date)}),c(b,d),void 0)},error:function(a){alert("Error: "+a.statusText)}})}function c(b,c){a.ajax({type:"GET",async:!0,dataType:"json",url:"https://api.github.com/users/"+c.github_id+"/repos",success:function(e){return 0===e.length?(alert("GitHub returned no repositories for this username!"),void 0):(e.forEach(function(e){var f=e.name,g=d(c,f);b.find("tr#distribution_"+f+" td.github_open_issues").html(a("<a>").attr("href","https://github.com/"+c.github_id+"/"+g+"/issues").html(e.open_issues_count))}),c.on_success&&c.on_success(e),void 0)},error:function(a){alert("Error: "+a.statusText)}})}function d(a,b){return a.repositories[b]?a.repositories[b]:a.repository_lowercase?b.toLowerCase():b}function e(b,c,e,f,g,h){var i=d(c,f),j={distribution:f,version:g,date:h,travis_status_badge:c.travis_ci?a("<a>").attr("href","https://travis-ci.org/"+c.github_id+"/"+i).html(a("<img>").attr("src","https://travis-ci.org/"+c.github_id+"/"+i+".png?branch=master").attr("alt","Build Status")):"",coveralls_badge:c.coveralls?a("<a>").attr("href","https://coveralls.io/r/"+c.github_id+"/"+i+"?branch=master").html(a("<img>").attr("src","https://coveralls.io/repos/"+c.github_id+"/"+i+"/badge.png?branch=master").attr("alt","Coverage Status")):"",github:a("<a>").attr("href","https://github.com/"+c.github_id+"/"+i).html("GitHub"),metacpan:a("<a>").attr("href","https://metacpan.org/release/"+f).html("MetaCPAN"),cpants:a("<a>").attr("href","http://cpants.cpanauthors.org/dist/"+f).html("CPANTS")},k=c.template_row.clone();for(var l in j)k.find("."+l).html(j[l]);k.css("display",""),k.attr("id","distribution_"+f),k.addClass("distribution"),k.removeClass("template"),b.find("tbody:last").append(k)}a.fn.createDistributionsList=function(c){var d=this;d.find("tbody:last tr.distribution").remove();var e=a.extend({pause_id:"AUBERTG",github_id:"guillaumeaubert",coveralls:!0,travis_ci:!0,repositories:{},repository_lowercase:!1,template_row:this.find("tr.template:first")},c);b(d,e)}}(jQuery);